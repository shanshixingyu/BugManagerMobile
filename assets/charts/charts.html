<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>缺陷报表</title>
    <link href="echarts/charts.css" rel="stylesheet" type="text/css"/>
    <script src="jquery/jquery.js" type="text/javascript"></script>
    <script src="echarts/echarts.js" type="text/javascript"></script>
    <style type="text/css">
        #bugChart0,
        #bugChart1,
        #bugChart2,
        #bugChart3,
        #bugChart4,
        #bugChart5,
        #bugChart6 {
        width: 100%;
        height: 300px;
        margin-top: 20px;
        margin-bottom: 50px;
        background-color: #ff0000;
        }
    </style>
</head>
<body>
<div id="bugChart0"></div>
<div id="bugChart1"></div>
<div id="bugChart2"></div>
<div id="bugChart3"></div>
<div id="bugChart4"></div>
<div id="bugChart5"></div>
<div id="bugChart6"></div>

<script type="text/javascript">
    $(document).ready(function () {
        require.config({
            paths: {
                echarts: 'js/echarts'
            }
        });

        require(
            [
                'echarts',
                'echarts/chart/bar',
                'echarts/chart/line',
                'echarts/chart/pie',
            ],
            drawCharts
        )
        ;

        function drawCharts(ec) {
            myChartElement.setOption(getPieChartOption(
                '<?php echo $chartTitle;?>',
                <?php echo Json::encode(array_keys(['data']));?>, '<?php echo $seriesName;?>',
                [<?php foreach($one['data'] as $key=>$value):?>
                    {value:<?php echo $value;?>, name: '<?php echo $key;?>'},
                    <?php endforeach;?>]
            ));
            myChartElement.setOption(getCommonChartOption(
                '<?php echo $chartTitle;?>', ['提交Bug数量'],
                <?php echo Json::encode(array_keys($one['data']));?>, '提交Bug数量',
                <?php echo Json::encode(array_values($one['data']))?>
            ));
        }


        function getCommonChartOption(titleText, legendData, xAxisData, seriesName, seriesData) {
            return {
                title: {
                    show: true,
                    text: titleText
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: legendData
                },
                toolbox: {
                    show: true,
                    feature: {
                        mark: {show: true},
                        dataView: {show: true, readOnly: true},
                        magicType: {show: true, type: ['line', 'bar']},
                        restore: {show: true},
                        saveAsImage: {show: true}
                    }
                },
                calculable: true,
                xAxis: [
                    {
                        type: 'category',
                        data: xAxisData
                    }
                ],
                yAxis: [
                    {
                        type: 'value',
                        splitArea: {show: true}
                    }
                ],
                series: [
                    {
                        name: seriesName,
                        type: 'bar',
                        data: seriesData
                    }
                ]
            };
        }

        function getPieChartOption(titleText, legendData, seriesName, seriesData) {
            return {
                title: {
                    show: true,
                    text: titleText
                },
                tooltip: {
                    trigger: 'item'
                },
                legend: {
                    data: legendData,
                    orient: 'horizontal',
                    x: 'center',
                    y: 'bottom'
                },
                toolbox: {
                    show: true,
                    feature: {
                        mark: {show: true},
                        dataView: {show: true, readOnly: true},
                        restore: {show: true},
                        saveAsImage: {show: true}
                    }
                },
                series: [
                    {
                        name: seriesName,
                        type: 'pie',
                        radius: '75%',
                        center: ['50%', '50%'],
                        data: seriesData
                    }
                ]
            };
        }
</script>
</body>
</html>
